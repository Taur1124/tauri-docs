---
title: Building a Flatpak
---

{/* 
- Maybe add some simple description of how flatpak works? 
- How do I add this to the navbar?
- Why is the "On this page" not showing the headers?
*/}

For detailed information on how flatpak works, you can read [Building your first Flatpak](https://docs.flatpak.org/en/latest/first-build.html)

The process of creating a flatpack can be simplified considerably by creating a .deb beforehand.
This .deb is then included as a single file in the flatpack.
Since additional dependencies and libraries of your app have to be added manually to the manifest of a flatpack, we cannot provide a one-click builder.

## General steps

**1. Install `flatpak` and `flatpak-builder`**

**2. Install the necessary runtime on your development machine or container**
```shell
flatpak install flathub org.Gnome.Platform//45 org.Gnome.Sdk//45
```

**3. Build the .deb of your tauri-app**

**4. Build and install the flatpak**
```shell
# Build the flatpak into a local repo
flatpak-builder --repo=<repo folder name> --force-clean build-dir <your flatpak id>

# Add the repo to your flatpak's list (host)
flatpak --user remote-add --no-gpg-verify <local repo name> <repo folder name>

# Install the flatpak (host)
flatpak -y --user install <local repo name> <your flatpak id>

# Run it (host)
flatpak run <your flatpak id>

# Update it (host)
flatpak -y --user update <your flatpak id>
```

If you are developing in a container that shares files with the host, you can install the flatpak on your host.
Any command with a `(host)` label can be executed on your host, while commands without this label must be executed inside the container. 
`(host)` commands must be executed from inside the flatpak directory on your host.


## Manifest Template
The following information works for the standard tauri-app, which can be created with 
```shell
cargo create-tauri-app -t vanilla -m cargo -y --alpha
```
The Gnome 45 runtime includes all dependencies of the standard Tauri app with their correct versions.
Assume the flatpak manifest is in `/flatpak/org.your.id.yml` and the tauri project is in `/tauri-app`.

```yaml
id: org.your.id

runtime: org.gnome.Platform
runtime-version: "45"
sdk: org.gnome.Sdk

command: tauri-app
finish-args:
  - --socket=wayland        # Permission needed to show the window
  - --socket=fallback-x11   # Permission needed to show the window
  - --device=dri            # OpenGL, not necessary for all projects

modules:
  - name: binary
    buildsystem: simple
    sources:
      - type: file
        path: ../tauri-app/src-tauri/target/release/bundle/deb/tauri-app_0.1.0_amd64/data/usr/bin/tauri-app
        # This path points to the binary file which was created in the .deb bundle. 
        # Tauri also creates a folder which corresponds to the content of the unpacked .deb.
    build-commands:
      - "install -Dm755 tauri-app /app/bin/tauri-app"
```

## Adding additional libraries
If your final binary requires more libraries than the default tauri app, you need to add them in your flatpak manifest.
There are two ways to do this. For fast local development, it may work to simply include the already built library file (`.so`) from your local system.
However, this is not recommended for the final build of the flatpak, as your local library file is not built for the flatpak runtime environment. 
This can introduce various bugs that can be very hard to find.
Therefore, it is recommended to build the library your program depends on from source inside the flatpak as a build step.

You can read more about this [in the flatpak documentation](https://docs.flatpak.org/en/latest/dependencies.html#bundling)
